---
import '../styles/navbar.css'
---

<header class="sticky top-0 z-50 w-full">
  <nav class="bg-royal-blue bg-opacity-95 shadow-lg backdrop-blur-sm">
    <div class="container mx-auto px-4 py-2">
      <div class="flex justify-between items-center">
        <!-- Logo y nombre -->
        <a href="/" class="flex items-center space-x-2 py-2">
          <img 
            src="/LogoEnviosDosRuedas.webp" 
            alt="Envios DosRuedas Logo" 
            width="50" 
            height="50"
            class="h-10 sm:h-12 w-auto transition-all"
          />
          <div class="hidden md:block">
            <h1 class="text-white text-lg sm:text-xl font-bold leading-tight">Envios DosRuedas</h1>
            <p class="text-mikado-yellow text-xs">Tu Solución Confiable para Envíos</p>
          </div>
        </a>

        <!-- Menú Desktop -->
        <div class="hidden lg:block">
          <ul class="flex space-x-1">
            <li>
              <a href="/" class="nav-link">
                <i class="fas fa-home mr-1"></i>
                Inicio
              </a>
            </li>
            <li class="relative group">
              <button class="nav-link">
                <i class="fas fa-truck-fast mr-1"></i>
                Servicios
                <i class="fas fa-chevron-down ml-1 text-xs"></i>
              </button>
              <div class="dropdown-menu w-60">
                <div class="py-1">
                  <a href="/mensajeria-envios-express" class="dropdown-item">
                    <i class="fas fa-shipping-fast mr-2 text-polynesian-blue"></i>
                    Envíos Express
                  </a>
                  <a href="/mensajeria-envios-lowcost" class="dropdown-item">
                    <i class="fas fa-hand-holding-dollar mr-2 text-polynesian-blue"></i>
                    Envíos LowCost
                  </a>
                  <a href="/delivery-moto-express" class="dropdown-item">
                    <i class="fas fa-motorcycle mr-2 text-polynesian-blue"></i>
                    Moto Express
                  </a>
                  <a href="/delivery-moto-fija" class="dropdown-item">
                    <i class="fas fa-clock mr-2 text-polynesian-blue"></i>
                    Moto Fija
                  </a>
                  <a href="/envios-emprendedores" class="dropdown-item">
                    <i class="fas fa-store mr-2 text-polynesian-blue"></i>
                    Plan Emprendedores
                  </a>
                  <a href="/enviosflex" class="dropdown-item">
                    <i class="fas fa-box mr-2 text-polynesian-blue"></i>
                    Envios Flex
                  </a>
                </div>
              </div>
            </li>
            <li class="relative group">
              <button class="nav-link">
                <i class="fas fa-calculator mr-1"></i>
                Cotizar
                <i class="fas fa-chevron-down ml-1 text-xs"></i>
              </button>
              <div class="dropdown-menu w-48">
                <div class="py-1">
                  <a href="/cotizador-envios-express" class="dropdown-item">
                    <i class="fas fa-bolt mr-2 text-polynesian-blue"></i>
                    Cotizar Express
                  </a>
                  <a href="/cotizador-envios-lowcost" class="dropdown-item">
                    <i class="fas fa-piggy-bank mr-2 text-polynesian-blue"></i>
                    Cotizar LowCost
                  </a>
                </div>
              </div>
            </li>
            <li class="relative group">
              <button class="nav-link">
                <i class="fas fa-users mr-1"></i>
                Nosotros
                <i class="fas fa-chevron-down ml-1 text-xs"></i>
              </button>
              <div class="dropdown-menu w-48">
                <div class="py-1">
                  <a href="/sobre-nosotros" class="dropdown-item">
                    <i class="fas fa-building mr-2 text-polynesian-blue"></i>
                    Sobre Nosotros
                  </a>
                  <a href="/preguntasfrecuentes" class="dropdown-item">
                    <i class="fas fa-question-circle mr-2 text-polynesian-blue"></i>
                    Preguntas Frecuentes
                  </a>
                  <a href="/nuestrasredes" class="dropdown-item">
                    <i class="fas fa-hashtag mr-2 text-polynesian-blue"></i>
                    Nuestras Redes
                  </a>
                </div>
              </div>
            </li>
            <li>
              <a href="/contacto" class="nav-link">
                <i class="fas fa-envelope mr-1"></i>
                Contacto
              </a>
            </li>
          </ul>
        </div>

        <!-- Menú móvil Toggle button -->
        <button 
          id="mobile-menu-button" 
          class="lg:hidden text-white focus:outline-none p-2 rounded-md hover:bg-polynesian-blue transition-colors"
          aria-label="Abrir menú"
          aria-expanded="false"
        >
          <i class="fas fa-bars text-xl"></i>
        </button>
      </div>

      <!-- Menú móvil -->
      <div id="mobile-menu" class="lg:hidden hidden mt-2 rounded-lg overflow-hidden transition-all duration-300 max-h-0">
        <nav class="bg-royal-blue bg-opacity-98">
          <ul class="flex flex-col pb-4">
            <li>
              <a href="/" class="mobile-nav-link">
                <i class="fas fa-home mr-2"></i>
                Inicio
              </a>
            </li>
            <!-- Servicios Dropdown Mobile -->
            <li class="mobile-dropdown">
              <button class="mobile-dropdown-button">
                <span>
                  <i class="fas fa-truck-fast mr-2"></i>
                  Servicios
                </span>
                <i class="fas fa-chevron-down transition-transform"></i>
              </button>
              <div class="mobile-dropdown-content">
                <a href="/mensajeria-envios-express" class="mobile-dropdown-item">
                  <i class="fas fa-shipping-fast mr-2"></i>
                  Envíos Express
                </a>
                <a href="/mensajeria-envios-lowcost" class="mobile-dropdown-item">
                  <i class="fas fa-hand-holding-dollar mr-2"></i>
                  Envíos LowCost
                </a>
                <a href="/delivery-moto-express" class="mobile-dropdown-item">
                  <i class="fas fa-motorcycle mr-2"></i>
                  Moto Express
                </a>
                <a href="/delivery-moto-fija" class="mobile-dropdown-item">
                  <i class="fas fa-clock mr-2"></i>
                  Moto Fija
                </a>
                <a href="/envios-emprendedores" class="mobile-dropdown-item">
                  <i class="fas fa-store mr-2"></i>
                  Plan Emprendedores
                </a>
                <a href="/enviosflex" class="mobile-dropdown-item">
                  <i class="fas fa-box mr-2"></i>
                  Envios Flex
                </a>
              </div>
            </li>
            <!-- Cotizar Dropdown Mobile -->
            <li class="mobile-dropdown">
              <button class="mobile-dropdown-button">
                <span>
                  <i class="fas fa-calculator mr-2"></i>
                  Cotizar
                </span>
                <i class="fas fa-chevron-down transition-transform"></i>
              </button>
              <div class="mobile-dropdown-content">
                <a href="/cotizador-envios-express" class="mobile-dropdown-item">
                  <i class="fas fa-bolt mr-2"></i>
                  Cotizar Express
                </a>
                <a href="/cotizador-envios-lowcost" class="mobile-dropdown-item">
                  <i class="fas fa-piggy-bank mr-2"></i>
                  Cotizar LowCost
                </a>
              </div>
            </li>
            <!-- Nosotros Dropdown Mobile -->
            <li class="mobile-dropdown">
              <button class="mobile-dropdown-button">
                <span>
                  <i class="fas fa-users mr-2"></i>
                  Nosotros
                </span>
                <i class="fas fa-chevron-down transition-transform"></i>
              </button>
              <div class="mobile-dropdown-content">
                <a href="/sobre-nosotros" class="mobile-dropdown-item">
                  <i class="fas fa-building mr-2"></i>
                  Sobre Nosotros
                </a>
                <a href="/preguntasfrecuentes" class="mobile-dropdown-item">
                  <i class="fas fa-question-circle mr-2"></i>
                  Preguntas Frecuentes
                </a>
                <a href="/nuestrasredes" class="mobile-dropdown-item">
                  <i class="fas fa-hashtag mr-2"></i>
                  Nuestras Redes
                </a>
              </div>
            </li>
            <li>
              <a href="/contacto" class="mobile-nav-link">
                <i class="fas fa-envelope mr-2"></i>
                Contacto
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </nav>
</header>

<script>
  // Mobile menu toggle functionality
  document.addEventListener('DOMContentLoaded', () => {
    const menuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const mobileDropdowns = document.querySelectorAll('.mobile-dropdown');
    
    if (menuButton && mobileMenu) {
      menuButton.addEventListener('click', () => {
        const expanded = menuButton.getAttribute('aria-expanded') === 'true';
        menuButton.setAttribute('aria-expanded', (!expanded).toString());
        
        if (expanded) {
          // Cerrar menú
          mobileMenu.classList.add('closing');
          (mobileMenu as HTMLElement).style.maxHeight = '0';
          
          setTimeout(() => {
            mobileMenu.classList.remove('closing');
            mobileMenu.classList.add('hidden');
            // Cambiar icono a hamburguesa
            menuButton.querySelector('i').classList.remove('fa-times');
            menuButton.querySelector('i').classList.add('fa-bars');
          }, 300);
        } else {
          // Abrir menú
          mobileMenu.classList.remove('hidden');
          setTimeout(() => {
            (mobileMenu as HTMLElement).style.maxHeight = mobileMenu.scrollHeight + 'px';
            // Cambiar icono a X
            menuButton.querySelector('i').classList.remove('fa-bars');
            menuButton.querySelector('i').classList.add('fa-times');
          }, 10);
        }
      });
    }
    
    // Manejo de dropdowns en móvil
    mobileDropdowns.forEach(dropdown => {
      const button = dropdown.querySelector('button');
      const content = dropdown.querySelector('.mobile-dropdown-content');
      const icon = button.querySelector('.fa-chevron-down');
      
      button.addEventListener('click', () => {
        const isOpen = content.classList.contains('active');
        
        // Cerrar todos los otros dropdowns
        document.querySelectorAll('.mobile-dropdown-content.active').forEach(openContent => {
          if (openContent !== content) {
            openContent.classList.remove('active');
            (openContent as HTMLElement).style.maxHeight = '0';
            const openIcon = openContent.previousElementSibling.querySelector('.fa-chevron-down');
            (openIcon as HTMLElement).style.transform = 'rotate(0deg)';
          }
        });
        
        if (isOpen) {
          // Cerrar este dropdown
          content.classList.remove('active');
          (content as HTMLElement).style.maxHeight = '0';
          (icon as HTMLElement).style.transform = 'rotate(0deg)';
        } else {
          // Abrir este dropdown
          content.classList.add('active');
          (content as HTMLElement).style.maxHeight = content.scrollHeight + 'px';
          (icon as HTMLElement).style.transform = 'rotate(180deg)';
        }
      });
    });
    
    // Ajustar altura del menú móvil al cambiar tamaño de ventana
    window.addEventListener('resize', () => {
      if (window.innerWidth >= 1024) { // lg breakpoint
        // Resetear menú móvil en desktop
        if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
          mobileMenu.classList.add('hidden');
          (mobileMenu as HTMLElement).style.maxHeight = '0';
          if (menuButton) {
            menuButton.setAttribute('aria-expanded', 'false');
            menuButton.querySelector('i').classList.remove('fa-times');
            menuButton.querySelector('i').classList.add('fa-bars');
          }
        }
      }
    });
  });
</script>